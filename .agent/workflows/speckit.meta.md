---
description: 從使用者描述產生詳細的專案元資料文件（00_meta.md），包含專案總覽、背景、範圍、利害關係人、團隊、優先順序等完整資訊。
---

## 使用者輸入

```text
$ARGUMENTS
```

觸發 `/speckit.meta` 時使用者在命令後所輸入的文本即為專案描述。假定該描述總是可得（除非為空），執行下列流程。

## 流程總覽

此命令用於在**專案初始階段**建立完整的專案元資料文件，作為後續 spec/plan/tasks 的基礎上下文。此命令應在 `/speckit.specify` 之前或平行執行。

## 執行步驟

### 1. 初始設定與路徑確認

1. **檢查當前環境**：
   - 執行 `git rev-parse --show-toplevel` 取得 repo root
   - 若不在 git repo 中，則使用當前目錄作為 REPO_ROOT
   - 設定 META_DIR = `$REPO_ROOT/project/meta`（專案層級元資料存放位置）

2. **檢查既有 meta 文件**：
   - 若 `$META_DIR/00_meta.md` 已存在，詢問使用者：
     - 「發現既有 00_meta.md，是否要更新？(yes/no/merge)」
     - `yes`: 完全覆寫
     - `no`: 中止執行
     - `merge`: 保留既有內容，僅更新使用者指定的章節
   - 若不存在，則建立新檔案

### 2. 資訊收集階段（動態問答）

**目標**：透過最多 **10 個精準問題**收集關鍵專案資訊，避免使用者需要從頭撰寫。

**問答策略**：
- 從 `$ARGUMENTS` 中擷取已提供的資訊（專案名稱、目標、範圍等）
- 僅詢問**未明確提及且會實質影響專案定位**的資訊
- 每題提供**推薦答案**或**選項表格**，使用者可快速確認或修改
- 支援使用者回答 `yes`/`skip`/`later` 快速跳過非必要問題

#### 問題分類與優先順序

**第 1 層：專案識別 (P0 - 必問)**

1. **Q1: 專案代號與名稱確認**
   ```
   專案代號格式建議：[部門縮寫]-[類型]-[序號]
   範例：FIN-IFRS-001、IT-SYS-INT-042

   **推薦專案代號**: [從 $ARGUMENTS 推導]
   **推薦專案名稱**: [從 $ARGUMENTS 推導]

   請確認或修改（直接回答代號和名稱，或回答 'yes' 接受推薦）
   ```

2. **Q2: 專案類型與性質**
   ```
   | 選項 | 專案類型 | 適用情境 |
   |------|----------|----------|
   | A | 新系統開發 | 從無到有建立新系統 |
   | B | 系統優化/升級 | 改善現有系統功能或效能 |
   | C | 系統整合 | 串接多個既有系統 |
   | D | 維護專案 | 持續性維護與小幅調整 |
   | E | 其他 | [請說明] |

   **推薦**: [從 $ARGUMENTS 推導]

   請選擇 (A/B/C/D/E 或 'yes' 接受推薦)
   ```

**第 2 層：核心背景 (P1 - 高優先)**

3. **Q3: 專案驅動因素**
   ```
   此專案的主要驅動因素是什麼？

   | 選項 | 驅動因素 | 說明 |
   |------|----------|------|
   | A | 監理/法遵要求 | 必須符合法規或主管機關要求 |
   | B | 業務需求/創新 | 支援新業務或提升競爭力 |
   | C | 成本/效率優化 | 降低成本或提升作業效率 |
   | D | 風險控制 | 降低營運或資安風險 |
   | E | 技術債償還 | 解決技術老舊或架構問題 |

   **推薦**: [從 $ARGUMENTS 推導]

   可多選，請輸入選項字母（例如：A,C）或 'yes' 接受推薦
   ```

4. **Q4: 關鍵時程與上線目標**
   ```
   專案預計上線時間：

   **推薦**: [從 $ARGUMENTS 推導或預設 3-6 個月後]

   格式：YYYY-MM-DD 或 YYYY-QX（季度）或 'flexible'（彈性）
   輸入日期或 'yes' 接受推薦
   ```

**第 3 層：範圍界定 (P2 - 中優先)**

5. **Q5: 涉及系統範圍**
   ```
   此專案會涉及哪些系統？

   請列舉：
   - 新建系統名稱（若有）
   - 需整合的既有系統（列出系統名稱）
   - 上游/下游系統

   **提示**: 若 $ARGUMENTS 已提及則自動填入

   格式：逐行列出或 'skip'（稍後手動填寫）
   ```

6. **Q6: 範圍邊界確認**
   ```
   請確認以下項目是否在專案範圍內：

   [根據 $ARGUMENTS 推導可能的範圍項目，逐項確認]

   - [項目 1]：包含 / 不包含 / 待定
   - [項目 2]：包含 / 不包含 / 待定

   或回答 'skip' 跳過此題
   ```

**第 4 層：組織與人員 (P2 - 中優先)**

7. **Q7: 專案負責人資訊**
   ```
   請提供關鍵負責人資訊（可部分填寫或稍後補充）：

   - 業務負責人：[姓名 / 職稱] (或 'unknown')
   - IT 專案負責人：[姓名 / 職稱] (或 'unknown')
   - 技術負責人：[姓名 / 職稱] (或 'unknown')

   格式：逐行輸入或 'skip'
   ```

8. **Q8: 主要利害關係人單位**
   ```
   請列出主要利害關係人單位（至少 2 個）：

   範例：
   - 財務部（需求提出單位）
   - 資訊部（開發執行單位）
   - 資安部（安全審查）
   - 法遵部（合規審查）

   請列出或 'skip'
   ```

**第 5 層：優先級與效益 (P3 - 可選)**

9. **Q9: 專案優先級**
   ```
   此專案的優先等級：

   | 選項 | 優先級 | 定義 |
   |------|--------|------|
   | A | P0 - Critical | 監理/法遵強制要求，影響營運 |
   | B | P1 - High | 重要業務需求，有明確時程壓力 |
   | C | P2 - Medium | 重要但可協調時程 |
   | D | P3 - Low | 優化性質，可延後 |

   **推薦**: [從驅動因素推導]

   請選擇 (A/B/C/D) 或 'yes' 接受推薦
   ```

10. **Q10: 預期效益類型**
    ```
    此專案主要帶來哪類效益？（可多選）

    | 選項 | 效益類型 | 範例 |
    |------|----------|------|
    | A | 成本節省 | 減少人工作業時間、降低錯誤率 |
    | B | 效率提升 | 加速流程、即時資料 |
    | C | 風險降低 | 資安強化、合規保證 |
    | D | 收益增加 | 新服務、業務擴展 |
    | E | 質化效益 | 使用者體驗、品牌形象 |

    請輸入選項字母（例如：A,B,C）或 'skip'
    ```

#### 問答規則

- **最多 10 題**，但若 `$ARGUMENTS` 已提供足夠資訊，可少於 10 題
- 每題必須提供**推薦答案或選項表格**
- 使用者可回答：
  - 具體答案
  - `yes` / `recommended` / `ok`（接受推薦）
  - `skip` / `later`（跳過此題，稍後手動填寫）
  - `stop` / `done`（終止問答，直接生成）
- 若使用者回答 `skip` 超過 3 題，提示：「已跳過多個問題，建議至少回答關鍵問題以確保文件完整性」

### 3. 資訊推導與補充

根據使用者回答和 `$ARGUMENTS`，自動推導以下資訊：

**推導規則**：

1. **專案代號生成**（若未提供）：
   - 從專案名稱擷取關鍵字
   - 格式：`[DEPT]-[TYPE]-[NUM]`
   - 範例：「跨子公司報表對齊」→ `FIN-RPT-ALIGN-001`

2. **時程規劃**（若僅提供上線日期）：
   - 倒推里程碑：上線日期往前推算
   - UAT: 上線前 4 週
   - 開發完成: 上線前 8 週
   - 設計審查: 上線前 12 週
   - 需求確認: 上線前 16 週

3. **RACI 矩陣骨架**：
   - 根據已知負責人和利害關係人單位生成基本 RACI 表格
   - 未知的部分標註 `[TBD]`

4. **成本與效益估算提示**：
   - 若未提供，在相應章節標註：`[需業務單位提供]` 或 `[需財務部門評估]`

5. **風險識別**：
   - 根據專案類型自動列出常見風險：
     - 系統整合 → 介接風險、資料一致性風險
     - 新系統開發 → 需求變更風險、技術選型風險
     - 監理專案 → 時程壓力風險、法規解讀風險

### 4. 生成 00_meta.md

1. **載入模板**：
   - 讀取 `.specify/templates/00_meta-template.md`

2. **填寫內容**：
   - 替換所有 `[PLACEHOLDER]` 為實際資訊
   - 對於未收集到的資訊：
     - 必填欄位：標註 `[TBD - 待補充]`
     - 選填欄位：標註 `[待評估]` 或保留範例格式
   - 填寫當前日期到 `[DATE]` 欄位

3. **內容品質檢查**：
   - **完整性檢查**：
     - [ ] 專案識別資訊完整（代號、名稱、類型）
     - [ ] 至少有 1 位專案負責人
     - [ ] 專案背景有實質描述（非空白或範例）
     - [ ] 範圍內/範圍外至少各有 2 項
     - [ ] 至少有 3 個利害關係人單位

   - **清晰度檢查**：
     - [ ] 專案目標具體可理解
     - [ ] 時程里程碑有明確日期或季度
     - [ ] 效益描述具體（避免過於空泛）

   - **一致性檢查**：
     - [ ] 優先級與驅動因素相符
     - [ ] 範圍與時程合理（範圍過大但時程過短 → 警告）
     - [ ] 涉及系統與利害關係人一致

4. **若檢查未通過**：
   - 回報未通過項目
   - 詢問使用者：「是否要補充資訊？(yes/no/later)」
   - `yes`: 針對未通過項目再次提問
   - `no` / `later`: 標註待補充並繼續生成

### 5. 寫入檔案

1. **建立目錄結構**：
   ```bash
   mkdir -p $REPO_ROOT/project/meta
   ```

2. **寫入 00_meta.md**：
   - 路徑：`$REPO_ROOT/project/meta/00_meta.md`
   - 若為 `merge` 模式，保留既有章節並更新指定章節

3. **建立 session 記錄**（追蹤）：
   - 在 00_meta.md 末尾附加：
     ```markdown
     ---

     ## 產生記錄

     ### Session YYYY-MM-DD HH:MM
     - 命令：`/speckit.meta`
     - 輸入：「$ARGUMENTS」
     - 問答輪數：[N] 題
     - 完整度：[X]% (已填欄位數/總欄位數)
     ```

### 6. 整合至 Constitution Check（選用）

若專案使用 constitution.md，檢查是否需要在 00_meta.md 中加入「憲法遵循聲明」章節：

```markdown
## 憲法遵循聲明

本專案承諾遵循 `.specify/memory/constitution.md` 定義的所有核心原則：
- [ ] I. 單一事實來源與狀態外部化
- [ ] II. Bot 輕量沙箱原則
- [ ] III. 測試驅動開發 (NON-NEGOTIABLE)
- [ ] VIII. 零信任與權限最小化
- [ ] IX. AI 回應有據與防護

若有違反，將在 plan.md「複雜度追蹤」章節記錄並提供正當理由。
```

### 7. 輸出與後續步驟建議

**成功輸出訊息**：
```
✅ 專案元資料文件已生成

📄 檔案路徑: $REPO_ROOT/project/meta/00_meta.md
📊 完整度: [X]% ([已填欄位數]/[總欄位數])

📋 已填寫章節:
  ✓ 專案總覽
  ✓ 專案背景
  ⚠️ 預算與成本 (待補充)
  ✓ 專案範圍
  ✓ 利害關係人
  ⚠️ 專案團隊 (部分待補充)
  ✓ 優先順序與依賴

⚠️ 待補充項目 ([N] 項):
  - 總預算與成本明細
  - 部分團隊成員資訊
  - 外部依賴細節

💡 下一步建議:
  1. 檢視並補充 [TBD] 標註的欄位
  2. 與利害關係人確認 RACI 矩陣
  3. 執行 `/speckit.specify <功能描述>` 開始撰寫功能規格
  4. 或先建立其他 Bank Profile 文件 (10_business.md, 20_process.md...)
```

**錯誤處理**：
- 若 `$ARGUMENTS` 為空且使用者拒絕回答任何問題 → ERROR: 「無法生成文件，至少需要專案名稱或描述」
- 若必填欄位（專案名稱、類型）無法推導 → ERROR: 「缺少必要資訊，請提供專案名稱和類型」

## 與其他命令的整合

### 與 /speckit.specify 的關係

- **執行順序**：`/speckit.meta` 應在 `/speckit.specify` **之前或平行**執行
- **資訊流向**：
  - 00_meta.md 提供專案層級上下文
  - spec.md 參考 meta 的範圍、利害關係人、優先級資訊
  - 建議在 spec.md 頂部加入連結：`**專案元資料**: [00_meta.md](../meta/00_meta.md)`

### 與 Bank Profile 擴充的關係

若未來實作 Bank Profile (10_business.md ~ 70_nfr.md)：
- 00_meta.md 為**基礎層**，定義專案識別與組織資訊
- 其他模板為**需求對齊層**，定義業務/技術/合規細節
- 建議順序：`00_meta → 10~70 → spec/plan/tasks`

## 特殊模式

### 快速模式 (Quick Mode)

若使用者傳入 `--quick` 或 `$ARGUMENTS` 非常詳細：
- 僅問 3 個關鍵問題（Q1, Q2, Q4）
- 其他資訊從 `$ARGUMENTS` 全自動推導
- 完整度可能較低，但快速產出

### 更新模式 (Update Mode)

若 00_meta.md 已存在：
- 載入既有內容
- 僅詢問「哪些章節需要更新？」
- 選項：
  - A: 專案總覽
  - B: 專案背景
  - C: 專案範圍
  - D: 利害關係人
  - E: 專案團隊
  - F: 優先順序與依賴
  - G: 全部重新生成
- 僅更新選定章節，保留其他內容

## 範例執行流程

**使用者輸入**:
```
/speckit.meta 建立跨子公司 IFRS 報表欄位對齊服務，用於金控合併報表自動化
```

**系統執行**:
1. 推導專案名稱：「跨子公司 IFRS 報表欄位對齊服務」
2. 推導專案代號：`FIN-IFRS-ALIGN-001`
3. 推導專案類型：系統整合（涉及多個子公司系統）
4. 詢問 Q3（驅動因素）→ 使用者選 A（監理/法遵）
5. 詢問 Q4（上線時間）→ 使用者輸入 `2025-Q4`
6. 詢問 Q5（涉及系統）→ 使用者列出子公司 A/B/C 會計系統
7. 跳過 Q6-Q10（使用者輸入 `skip`）
8. 自動推導時程、RACI、風險
9. 生成 00_meta.md（完整度 65%）
10. 提示待補充項目並建議下一步

## 品質標準

產出的 00_meta.md 必須符合：
- **完整性**: 核心章節至少 50% 完整度
- **可讀性**: 無範例文字殘留，所有描述具體
- **可操作性**: RACI 矩陣、時程、範圍清晰，可作為專案執行依據
- **可追溯性**: 記錄產生來源（命令輸入、問答記錄）
- **可維護性**: 提供版本歷史表格，支援未來更新

## 注意事項

1. **不要過度詢問**：最多 10 題，優先從 `$ARGUMENTS` 推導
2. **不要空泛建議**：所有推薦答案必須基於實際輸入推導
3. **不要遺漏必填**：專案名稱、代號、類型必須確保有值
4. **不要靜默失敗**：任何異常都應明確告知使用者
5. **不要修改既有內容**（除非明確要求更新模式）

