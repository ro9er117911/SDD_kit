---
description: 從專案上下文產生風險與控制設計文件（30_risk_control.md），包含風險識別、控制措施、RACI 矩陣與監控指標。
---

## 使用者輸入

```text
$ARGUMENTS
```

## 流程總覽

此命令用於**識別專案風險並設計控制措施**，是 Bank Profile 需求對齊層的風險管理文件。應在完成 10_business.md 和 20_process.md 後執行。

## 目標定位

**30_risk_control.md 關注**：
- WHAT-RISK：可能發生什麼風險（業務/技術/資料/作業/合規/資安）
- WHY-RISK：為什麼會發生（風險來源）
- WHAT-IF：若發生會造成什麼影響
- HOW-CONTROL：如何預防、偵測、回應（控制措施）
- WHO-RESPONSIBLE：誰負責風險管理（RACI）

**NOT in scope**：技術實作細節（屬於 plan.md）

## 執行步驟

### 1. 初始設定與上下文載入

1. **檢查專案環境**並載入上下文：
   - `specs/meta/00_meta.md`（專案背景、利害關係人）
   - `specs/business/10_business.md`（業務目標、痛點）
   - `specs/process/20_process.md`（流程、例外情境）
   - 設定 RISK_DIR = `$REPO_ROOT/specs/risk`

2. **檢查既有文件**：
   - 若 `30_risk_control.md` 已存在：詢問 yes/no/merge
   - 若不存在：建立新檔案

### 2. 智能風險識別（7 個問題）

**第 1 層：風險識別 (P0)**

1. **Q1: 主要風險類別確認**
   ```
   此專案最需關注的風險類別是什麼？（可多選）

   | 選項 | 風險類別 | 何時重點關注 |
   |------|----------|--------------|
   | A | 業務風險 | 使用者接受度、效益達成 |
   | B | 技術風險 | 技術選型、整合、效能 |
   | C | 資料風險 | 資料品質、洩漏、遺失 |
   | D | 作業風險 | 人為錯誤、流程中斷 |
   | E | 合規風險 | 法規違反、監理要求 |
   | F | 資安風險 | 未授權存取、資料外洩 |
   | G | 專案風險 | 時程、預算、資源 |

   **從上下文推導的建議**: [根據業務性質推導，如：涉及個資→F,E 必選]

   請選擇重點關注的類別（例如：A,B,F）或 'yes' 接受推薦
   ```

2. **Q2: 從業務痛點識別風險**
   ```
   從 10_business.md 的痛點，推導以下潛在風險：

   [從痛點自動推導風險]
   範例：痛點「人工撰寫易遺漏」→ 風險「AI 模型也可能遺漏關鍵資訊」

   請確認這些風險（yes/modify）並補充其他風險
   ```

**第 2 層：影響評估 (P1)**

3. **Q3: 高影響風險優先級**
   ```
   哪些風險若發生會造成嚴重影響？（選 3-5 個最關鍵）

   **推導的高影響風險**:
   - [風險 A]: [預估影響]
   - [風險 B]: [預估影響]

   請確認或調整優先級
   ```

4. **Q4: 風險發生機率評估**
   ```
   這些高影響風險的發生機率如何？

   對每個風險評估：高 (H) / 中 (M) / 低 (L)

   提示：
   - 高：發生機率 > 50% 或過去發生過
   - 中：20-50% 或業界有案例
   - 低：< 20% 或罕見

   （或回答 'later' 稍後補充）
   ```

**第 3 層：控制設計 (P2)**

5. **Q5: 既有控制措施**
   ```
   當前是否已有任何控制措施？（針對識別的風險）

   範例：
   - 人工審核機制（針對 AI 錯誤風險）
   - 權限管理（針對資料外洩風險）
   - 備份機制（針對資料遺失風險）

   請列出既有控制或回答 'none'（將設計新控制）
   ```

6. **Q6: 控制措施類型偏好**
   ```
   對於高風險項目，偏好哪種控制方式？

   | 選項 | 控制類型 | 說明 |
   |------|----------|------|
   | A | 預防性控制 | 防止風險發生（如：存取控制、驗證機制） |
   | B | 偵測性控制 | 及早發現風險（如：監控、告警） |
   | C | 回應性控制 | 降低風險影響（如：備份、應急計畫） |
   | D | 平衡組合 | 多層防護 |

   **推薦**: D（平衡組合）

   請選擇或 'yes' 接受推薦
   ```

**第 4 層：監控與報告 (P3)**

7. **Q7: 風險監控需求**
   ```
   風險監控頻率與報告對象？

   - 日常監控：[每日/每週] 報告給 [角色]
   - 定期報告：[每月/每季] 報告給 [角色]
   - 重大事件：立即報告給 [角色]

   （或回答 'standard' 使用標準監控機制）
   ```

### 3. 風險自動生成

**從上下文推導風險**：

1. **從 10_business.md 痛點推導**：
   - 痛點「人工耗時」→ 風險「AI 產出品質不符預期，仍需大量人工」
   - 痛點「格式不一致」→ 風險「使用者不遵循新流程」

2. **從 20_process.md 例外情境推導**：
   - 例外「AI 無法產生摘要」→ 風險「模型失效影響業務連續性」
   - 例外「資料異常」→ 風險「資料品質問題導致錯誤輸出」

3. **從專案類型推導常見風險**：
   - AI/ML 專案 → 模型偏差、訓練資料洩漏、過度依賴
   - 整合專案 → 介面不相容、資料格式不一致
   - 金融專案 → 法規遵循、資料保護、稽核追蹤

4. **自動評估風險等級**：
   - 涉及個資/金融資料 → 資料風險等級「高」
   - 監理要求相關 → 合規風險等級「高」
   - 新技術採用 → 技術風險機率「中-高」

### 4. 控制措施自動設計

**控制措施生成規則**：

1. **三層防護策略**：
   - 第 1 層：預防（存取控制、驗證、審批流程）
   - 第 2 層：偵測（監控、告警、日誌）
   - 第 3 層：回應（備份、應急計畫、補救措施）

2. **從風險類型匹配標準控制**：
   - 資料風險 → 加密、備份、存取控制
   - 作業風險 → 人工審核、雙重確認、檢查清單
   - 技術風險 → 測試、監控、容錯設計
   - 合規風險 → 稽核軌跡、政策遵循、定期檢查

3. **控制措施對應 20_process.md 步驟**：
   - 在流程關鍵點插入控制
   - 範例：「AI 產生摘要」步驟 → 插入「信心分數檢查」控制

### 5. RACI 矩陣生成

**從利害關係人推導 RACI**：
- 業務單位 → 風險識別 (C)、接受決策 (A)
- IT 單位 → 控制實施 (R)、技術風險 (A)
- 資安/法遵 → 資安/合規風險 (A)、控制審查 (C)
- 稽核 → 控制測試 (R)、監控報告 (I)

### 6. KRI 指標生成

**自動生成關鍵風險指標**：

從風險類型生成 KRI：
- 模型品質風險 → KRI: 模型錯誤率 < 5%
- 資料外洩風險 → KRI: 異常存取次數 < 10/日
- 作業風險 → KRI: 人工審核退回率 < 10%
- 系統可用性風險 → KRI: 系統可用率 > 99.5%

### 7. 品質檢查

**完整性檢查**：
- [ ] 至少識別 5 個主要風險
- [ ] 每個高/極高風險有對應控制措施
- [ ] RACI 矩陣包含所有關鍵活動
- [ ] 至少定義 3 個 KRI

**一致性檢查**：
- [ ] 風險與 10_business.md 痛點對齊
- [ ] 控制措施與 20_process.md 流程整合
- [ ] RACI 角色與 00_meta.md 利害關係人一致

### 8. 生成 30_risk_control.md

1. 載入模板並填寫內容
2. 插入自動生成的風險、控制、RACI、KRI
3. 生成風險-控制對照矩陣
4. 計算風險覆蓋率

### 9. 輸出訊息

```
✅ 風險與控制設計文件已生成

📄 檔案路徑: specs/risk/30_risk_control.md

📊 風險分析摘要:
  ✓ 識別風險: [N] 個
    - 極高風險: [X] 個
    - 高風險: [Y] 個
    - 中風險: [Z] 個
  ✓ 控制措施: [M] 個
    - 預防性: [X] 個
    - 偵測性: [Y] 個
    - 回應性: [Z] 個
  ✓ 風險覆蓋率: [P]% (有控制措施的風險比例)
  ✓ 殘餘風險: [N] 個風險降至「中」或「低」

🎯 優先處理項目:
  1. [極高/高風險名稱] - [建議控制措施]
  2. [風險名稱] - [建議措施]

⚠️ 需風險接受決策:
  - [風險 ID]: [原因]（殘餘風險仍為「高」）

💡 下一步建議:
  1. 與風險負責人確認風險評估準確性
  2. 與技術團隊確認控制措施可行性
  3. 執行 `/speckit.infosec` 補充資安詳細需求
  4. 或執行 `/speckit.specify --from-bank-profile` 產生技術規格
```

## 與其他命令的整合

- **10_business.md** 的痛點 → **30_risk_control.md** 的風險
- **20_process.md** 的例外 → **30_risk_control.md** 的風險與控制點
- **40_infosec.md** 的資安控制 → **30_risk_control.md** 整合為控制措施

## 特殊模式

### 快速模式 (--quick)
- 僅問 3 題（Q1, Q2, Q3）
- 自動推導所有風險、控制、RACI

### 從 process 繼承 (--from-process)
- 從 20_process.md 的痛點與例外自動識別風險
- 減少問答至 2-3 題

## 案例：STR/SAR 摘要模型

輸入: `/speckit.risk`

系統推導：
1. **風險類別**: E (合規)、F (資安)、D (作業) - 因涉及金融監理與個資
2. **主要風險**:
   - R-001: 模型遺漏關鍵可疑行為（高影響、中機率）
   - R-002: 模型錯誤導致誤導性描述（高影響、低機率）
   - R-003: 分析人員過度依賴模型（中影響、高機率）
   - R-004: 訓練資料洩漏個資（高影響、中機率）
3. **控制措施**:
   - C-001: 強制人工審核（預防 R-001/R-002）
   - C-002: 最小必備欄位檢查（偵測 R-001）
   - C-003: UI 強制顯示原始資料（預防 R-003）
   - C-004: 訓練資料隔離環境（預防 R-004）
4. **KRI**:
   - 模型建議被修改率 > 30% → 警示
   - 異常存取模型服務 > 5 次/日 → 警示

## 注意事項

1. **聚焦業務風險**：技術風險僅列高層級，實作細節留給 plan.md
2. **控制可行性**：確保控制措施技術與成本可行
3. **監理對齊**：金融/醫療等受監理產業需特別關注合規風險
4. **殘餘風險管理**：高殘餘風險需明確風險接受決策
