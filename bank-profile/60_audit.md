# 60_audit - 稽核可稽性需求

**建立日期**: 2025-11-19
**最後更新**: 2025-11-19
**文件版本**: 1.0.0
**關聯文件**:
- 流程設計: [20_process.md](20_process.md)
- 風險控制: [30_risk_control.md](30_risk_control.md)
- 資安需求: [40_infosec.md](40_infosec.md)
- 法遵需求: [50_compliance.md](50_compliance.md)
**輸入**: 自動推導模式 (Based on Bank Profile)

---

## 文件目的

本文件定義「客戶洗錢風險事件摘要模型」專案的稽核可稽性需求，確保系統操作具備完整之稽核軌跡 (Audit Trail)，並滿足法規對於證據留存之要求。
重點涵蓋：
1. **稽核事件 (Audit Events)**: 定義必須記錄的關鍵業務與系統操作。
2. **日誌結構 (Log Structure)**: 定義標準化日誌格式與欄位。
3. **資料保留 (Data Retention)**: 定義日誌與證據的保留期限。
4. **稽核報表 (Audit Reports)**: 定義需產出的稽核分析報表。

---

## 1. 稽核事件識別

### 1.1 業務操作事件 (Business Operations)

| 事件 ID | 事件名稱 | 觸發時機 | 稽核目的 | 優先級 |
|---------|----------|----------|----------|--------|
| **AE-BIZ-001** | **查看案件詳情** | 使用者點擊案件進入詳情頁時 | 證明敏感資料存取之合理性 (Need-to-know) | P0 |
| **AE-BIZ-002** | **請求模型摘要** | 系統呼叫 AI 模型生成摘要時 | 證明使用 AI 輔助且模型正常運作 | P0 |
| **AE-BIZ-003** | **修改摘要內容** | 使用者編輯 AI 生成之摘要內容時 | 追蹤人工審核介入程度與修改軌跡 | P0 |
| **AE-BIZ-004** | **提交審核決策** | 使用者送出案件 (核准/退回) 時 | 記錄最終決策者與決策時間 | P0 |
| **AE-BIZ-005** | **搜尋客戶資料** | 使用者使用關鍵字搜尋客戶時 | 偵測異常查詢行為 (如肉搜 VIP) | P1 |

### 1.2 系統管理事件 (System Management)

| 事件 ID | 事件名稱 | 觸發時機 | 稽核目的 | 優先級 |
|---------|----------|----------|----------|--------|
| **AE-SYS-001** | **模型版本變更** | 管理員切換使用之模型版本時 | 確保模型治理與版本可追溯 | P0 |
| **AE-SYS-002** | **權限角色異動** | 管理員新增/修改/刪除使用者權限時 | 確保存取控制之有效性 | P0 |
| **AE-SYS-003** | **系統參數調整** | 管理員修改系統全域設定時 | 追蹤系統組態變更 | P1 |

### 1.3 資安事件 (Security Events)

| 事件 ID | 事件名稱 | 觸發時機 | 稽核目的 | 優先級 |
|---------|----------|----------|----------|--------|
| **AE-SEC-001** | **登入失敗** | 使用者登入驗證失敗時 | 偵測暴力破解攻擊 | P1 |
| **AE-SEC-002** | **異常時段存取** | 非工作時間存取敏感資料時 | 偵測異常內部行為 | P1 |
| **AE-SEC-003** | **大量資料匯出** | 使用者執行批次匯出功能時 | 防止資料外洩 (DLP) | P0 |

---

## 2. 日誌結構與格式

### 2.1 標準日誌欄位

所有稽核日誌皆需包含以下標準欄位：

| 欄位名稱 | 資料類型 | 說明 | 範例 |
|----------|----------|------|------|
| `log_id` | UUID | 唯一識別碼 | `550e8400-e29b-41d4-a716-446655440000` |
| `timestamp` | ISO8601 | 事件發生時間 (UTC) | `2025-11-19T03:30:00Z` |
| `event_type` | String | 事件 ID | `AE-BIZ-003` |
| `user_id` | String | 操作者 ID | `emp12345` |
| `user_role` | String | 操作者當下角色 | `Analyst` |
| `source_ip` | String | 來源 IP 位址 | `192.168.1.100` |
| `result` | String | 操作結果 | `Success`, `Failure` |
| `details` | JSON | 事件詳細資訊 (依事件類型不同) | `{ "case_id": "STR-2025-001", ... }` |

### 2.2 業務欄位定義 (Details)

針對 `AE-BIZ-003` (修改摘要內容) 之 `details` 結構範例：

```json
{
  "case_id": "STR-2025-001",
  "model_version": "v1.2.0",
  "field_changed": "summary_text",
  "before_value": "客戶於短時間內頻繁存入大額現金...",
  "after_value": "客戶(王大明)於短時間內頻繁存入大額現金(累計500萬)...",
  "edit_distance": 15,
  "time_spent_seconds": 120
}
```

### 2.3 敏感資料遮罩

日誌中若包含敏感資料，需依 `40_infosec.md` 規則進行遮罩：

- **姓名**: `王**`
- **身分證**: `******1234`
- **帳號**: `*******56789`

---

## 3. 資料保留與查詢

### 3.1 保留期限矩陣

依據 `50_compliance.md` 之法規要求：

| 日誌類型 | 適用法規 | 保留期限 | 儲存媒體 |
|----------|----------|----------|----------|
| **業務操作日誌** | 洗錢防制法 | **7 年** | 線上 1 年 + 封存 6 年 |
| **系統管理日誌** | 內部政策 | **3 年** | 線上 1 年 + 封存 2 年 |
| **資安事件日誌** | 資通安全法 | **1 年** | 線上 6 個月 + 封存 6 個月 |

### 3.2 查詢能力需求

稽核系統需支援以下維度之快速查詢 (回應時間 < 5 秒)：

- **依案件查詢**: 查詢特定 `case_id` 的所有操作歷程 (還原案件全貌)。
- **依人員查詢**: 查詢特定 `user_id` 在特定期間的所有操作 (人員行為稽核)。
- **依事件查詢**: 查詢特定 `event_type` (如匯出資料) 的所有紀錄。
- **複合查詢**: 時間區間 + 人員 + 事件類型。

---

## 4. 稽核報表與告警

### 4.1 定期稽核報表

| 報表 ID | 報表名稱 | 頻率 | 內容說明 | 對應 KRI |
|---------|----------|------|----------|----------|
| **RA-AML-001** | **分析人員模型使用統計** | 每月 | 統計每位分析人員採納 AI 建議的比例、修改幅度、處理時間。 | KRI-001 |
| **RA-AML-002** | **STR 個案處理效率分析** | 每月 | 統計案件平均處理時間、積壓案件數、SLA 達成率。 | KRI-002 |
| **RA-SEC-001** | **異常存取行為報告** | 每週 | 列出非上班時間存取、大量查詢、VIP 客戶存取紀錄。 | KRI-004 |
| **RA-SYS-001** | **系統管理操作紀錄** | 每月 | 彙整權限變更、模型版本更新等特權操作。 | - |

### 4.2 即時稽核告警

| 告警 ID | 規則名稱 | 觸發條件 | 通知對象 |
|---------|----------|----------|----------|
| **ALERT-SEC-001** | **異常大量查詢** | 單一使用者 10 分鐘內查詢 > 50 筆案件 | 資安官 |
| **ALERT-SEC-002** | **VIP 資料存取** | 任何對 VIP/PEP 客戶資料的存取 | 法遵長 |
| **ALERT-BIZ-001** | **模型建議全盤否決** | 分析人員連續 5 筆案件完全刪除 AI 摘要 | 風控主管 |

---

## 5. 稽核 RACI 矩陣

| 活動 | 稽核部門 | IT 部門 | 法遵部門 | 資安部門 |
|------|----------|---------|----------|----------|
| **稽核事件定義** | **A** | C | C | C |
| **日誌系統實作** | I | **R** | I | C |
| **日誌保存管理** | I | **R** | C | C |
| **稽核報表審閱** | **R** | I | **R** | I |
| **異常告警處理** | I | I | **A** | **A** |

---

## 6. 下一步建議

1. **技術評估**: 評估 7 年日誌保留之儲存成本，規劃冷熱資料分層儲存架構 (如 Elasticsearch + S3 Glacier)。
2. **報表開發**: 針對 RA-AML-001 等關鍵報表進行 UI/UX 設計與開發。
3. **非功能需求**: 執行 `/speckit.nfr` 定義日誌系統之效能與容量需求。
