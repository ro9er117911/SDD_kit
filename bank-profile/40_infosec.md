# 40_infosec - 資安需求與權限矩陣

**建立日期**: 2025-11-19
**最後更新**: 2025-11-19
**文件版本**: 1.0.0
**關聯文件**:
- 業務目標: [10_business.md](10_business.md)
- 流程設計: [20_process.md](20_process.md)
- 風險控制: [30_risk_control.md](30_risk_control.md)
**輸入**: 自動推導模式 (Based on Bank Profile)

---

## 文件目的

本文件定義「客戶洗錢風險事件摘要模型」專案的資訊安全需求，確保系統符合金融資安規範與個資保護要求。
重點涵蓋：
1. **資料分級 (Data Classification)**: 定義資料敏感度與保護等級。
2. **權限矩陣 (Access Matrix)**: 定義角色對資料的存取權限。
3. **身分驗證 (Authentication)**: 定義登入與認證機制。
4. **資料保護 (Data Protection)**: 定義加密、遮罩與傳輸安全。
5. **稽核日誌 (Audit Logs)**: 定義需記錄的操作與保留期限。

---

## 1. 資料分級與保護

### 1.1 資料敏感度分級

根據專案處理資料之性質，定義以下資料分級：

| 資料類型 | 敏感度等級 | 定義 | 範例欄位 | 保護要求 |
|----------|------------|------|----------|----------|
| **個人資料 (PII)** | **高度機密 (Confidential)** | 可直接或間接識別自然人之資料 | 姓名、身分證字號、電話、地址 | 傳輸加密、靜態加密、嚴格權限、遮罩顯示 |
| **金融交易資料** | **高度機密 (Confidential)** | 客戶帳戶、交易明細、資產狀況 | 帳號、交易金額、餘額、交易對手 | 傳輸加密、靜態加密、嚴格權限 |
| **洗錢防制資料** | **機密 (Restricted)** | 風險評分、STR/SAR 報告、調查紀錄 | 風險等級、摘要內容、審核意見 | 傳輸加密、存取控制、完整稽核軌跡 |
| **系統營運資料** | **內部 (Internal)** | 系統日誌、效能指標、組態設定 | 錯誤碼、執行時間、API 狀態 | 存取控制、定期備份 |

### 1.2 敏感欄位清單

下列欄位為本系統處理之最高敏感資料，需實施欄位級加密或遮罩：

1. **客戶姓名 (Customer Name)**: PII
2. **身分證字號 (National ID)**: PII (Unique ID)
3. **銀行帳號 (Account Number)**: 金融資料
4. **交易金額 (Transaction Amount)**: 金融資料
5. **風險摘要文本 (Risk Summary)**: 含敏感個資與調查細節

---

## 2. 存取控制與權限矩陣

### 2.1 角色定義

參考 `10_business.md` 定義之角色：

- **AML 分析人員 (Analyst)**: 負責案件調查與摘要撰寫。
- **法遵審核主管 (Reviewer)**: 負責案件審核與決策。
- **風控/模型人員 (Modeler)**: 負責模型監控與優化。
- **稽核人員 (Auditor)**: 負責事後查核。
- **系統管理員 (Admin)**: 負責系統維運與帳號管理。

### 2.2 權限矩陣 (RBAC)

| 資料/功能 | AML 分析人員 | 法遵審核主管 | 風控/模型人員 | 稽核人員 | 系統管理員 |
|-----------|--------------|--------------|---------------|----------|------------|
| **案件列表** | 檢視 (Own/Group) | 檢視 (All) | 檢視 (All) | 檢視 (All) | 無 |
| **PII 明細 (未遮罩)** | 檢視 | 檢視 | 無 | 無 | 無 |
| **PII 明細 (遮罩)** | - | - | 檢視 | 檢視 | 無 |
| **風險摘要** | 編輯/檢視 | 批註/檢視 | 檢視 | 檢視 | 無 |
| **審核決策** | 無 | 執行 | 無 | 無 | 無 |
| **模型參數** | 無 | 無 | 編輯/檢視 | 檢視 | 無 |
| **稽核日誌** | 無 | 無 | 無 | 檢視/匯出 | 檢視 |
| **使用者管理** | 無 | 無 | 無 | 無 | 執行 |

**備註**:
- **Own/Group**: 僅能檢視分派給自己或所屬群組的案件。
- **VIP 客戶存取**: 需額外具備 VIP 白名單權限方可存取 (參見 `30_risk_control.md` C-F02-1)。

---

## 3. 身分驗證與安全機制

### 3.1 驗證機制

- **內部使用者**: 採用 **SSO (Single Sign-On)** 整合企業 AD/LDAP。
- **多因子認證 (MFA)**:
  - **強制啟用情境**:
    - 從外部網路 (VPN/Internet) 存取時。
    - 存取 VIP/PEP 高敏感客戶資料時。
    - 系統管理員執行特權操作時。
  - **認證方式**: 手機 OTP 或硬體 Token。

### 3.2 連線階段管理

- **Session Timeout**: 閒置 15 分鐘自動登出。
- **並發登入限制**: 同一帳號限制同時僅能由一個裝置登入。
- **登入失敗鎖定**: 連續失敗 5 次鎖定帳號 30 分鐘。

---

## 4. 資料保護技術規格

### 4.1 加密機制

- **傳輸加密 (Data in Transit)**:
  - 全程使用 **TLS 1.2** 或以上版本。
  - 禁用弱加密演算法 (如 RC4, MD5)。
  - 憑證需由受信任 CA 簽發。

- **靜態加密 (Data at Rest)**:
  - 資料庫敏感欄位 (PII, 金融資料) 使用 **AES-256** 加密儲存。
  - 備份檔案需加密儲存。
  - 金鑰管理 (KMS) 需與資料儲存分離。

### 4.2 資料遮罩規則 (Data Masking)

針對非必要檢視原始資料之角色 (如稽核、模型人員)，實施動態遮罩：

| 欄位 | 遮罩規則 | 範例 |
|------|----------|------|
| **姓名** | 顯示姓氏，其餘以 * 取代 | 林** |
| **身分證字號** | 顯示後 4 碼，其餘以 * 取代 | ******1234 |
| **銀行帳號** | 顯示後 5 碼，其餘以 * 取代 | *******56789 |
| **電話號碼** | 中間 3 碼以 * 取代 | 0912-***-789 |
| **地址** | 顯示縣市/區，其餘以 * 取代 | 台北市信義區*** |

---

## 5. 稽核日誌與監控

### 5.1 日誌記錄範圍

系統需記錄所有關鍵操作，以滿足不可否認性 (Non-repudiation) 與稽核需求。

| 事件類型 | 記錄內容 | 觸發動作 |
|----------|----------|----------|
| **登入/登出** | 時間、IP、使用者 ID、結果 | 登入成功/失敗、登出、Timeout |
| **資料存取** | 時間、IP、使用者 ID、資料 ID、動作 | 檢視案件詳情、搜尋客戶 |
| **資料異動** | 時間、IP、使用者 ID、資料 ID、異動前/後值 | 編輯摘要、提交案件 |
| **審核作業** | 時間、IP、使用者 ID、案件 ID、決策、意見 | 核准、退回 |
| **特權操作** | 時間、IP、使用者 ID、動作內容 | 權限變更、參數調整 |
| **異常事件** | 時間、IP、錯誤碼、堆疊資訊 | 系統錯誤、API 逾時 |

### 5.2 日誌管理

- **保留期限**: 至少 **7 年** (依金融法規要求)。
- **保護機制**: 日誌檔需加密並寫入 WORM (Write Once Read Many) 儲存媒體，防止竄改。
- **監控告警**:
  - 短時間大量資料匯出/查詢。
  - 非上班時間的異常存取。
  - VIP 客戶資料存取。
  - 連續登入失敗。

---

## 6. 合規與法規遵循

### 6.1 適用法規

- **個人資料保護法 (PDPA)**: 確保個資蒐集、處理、利用符合法規。
- **金融機構辦理電腦系統資訊安全評估辦法**: 符合第一類電腦系統要求。
- **洗錢防制法**: 確保相關資料保存與申報符合規定。

### 6.2 合規檢查清單

- [ ] **個資告知**: 系統介面需有隱私權宣告。
- [ ] **最小揭露**: 介面僅顯示業務必要之欄位。
- [ ] **被遺忘權**: 需具備個資刪除/去識別化之技術機制 (當法定保存期限屆滿)。
- [ ] **資料跨境**: 若涉及跨境傳輸，需符合主管機關規範。

---

## 7. 下一步建議

1. **技術實作**: 開發團隊依據本文件之權限矩陣與加密需求進行系統設計 (`spec.md` & `plan.md`)。
2. **資安檢測**: 上線前需執行源碼檢測 (SAST) 與滲透測試 (PT)，驗證上述控制措施之有效性。
3. **法遵確認**: 請法遵部門確認遮罩規則與日誌保留期限是否符合最新內部規範。
